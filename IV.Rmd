---
title: "IV"
author: "Victor maj Møk 1"
date: "2024-12-13"
output: html_document
---

Consider the following DAG for a problem when using Instrumental Variables. Indsæt DAG
Consider also the corsponding SWIG. 

In order to succesfully introduces a Instrumental Variables to establish a casusal relation. we must make sure that the Instrumental Variables satisfies. the exclusion restriction, we futher have to make sure that there is a non-zero first-stage and lastly that the monotonicity assumption holdes. if we are looking at local average treatment effect (LATE).

the research paper Enemy patents as a Instrumental Variables where it goes through the mediator number of license to the outcome patents by us inventors. the papir says 

"Enemy  patents  is  highly  correlated  with  the  number  of  licenses  that  were  granted  to  US  firms,  but  variation  in  enemy  patents(other  than  those  that  were  licensed) should not by itself increase domestic invention"
here they are reffering to the "exclusion restriction" and the "non-zero first-stage" assumption of Instrumental Variables. 

The exclusion restriction:
 however the paprr does not show that these assumption hold. the no exclusion restriction is an untestable assumption, so we need to logically argue that there is a no path from 
z -> y other that only through the mediator. 

skriv om hvorfor at at det holder. 


non-zero first-stage:
not lets check to see if we have a strong instrument. the non-zero first-stage assumption is a testable assumption. so using a standard Technics used in the turtoriels we find that.
not that in the papir is looking at the postTWEA in the IV part. 
```{r}
#First stage 
twea_df_posttwea <- Data %>% 
  filter(
    twea == 1
  )

model_fs <- lm(count_cl_itt ~ count_germany, data = twea_df_posttwea)
robust_se <- coeftest(model_fs, vcov = vcovHC(model_fs, type = "HC3"))
round(robust_se, 4)

summary(model_fs)$fstatistic
```
here we see that counter_cl_itt that are Number of available patents under forced licensing. 



now lets try to compute the 2SLS 
```{r}
iv_model <- ivreg(count_usa ~ count_cl_itt | count_germany , data = twea_df_posttwea)
robust_se <- coeftest(iv_model, vcov = vcovHC(iv_model, type = "HC0"))
round(robust_se,digits = 4)

```
here we see the 2SLS. se wee a postiv correlation
lets for good measure also just check 
```{r}
iv.summary <- summary(iv_model, diagnostics=TRUE, vcov=sandwich::sandwich)
round(iv.summary$diagnostics["Weak instruments",], 4)
```

 and 
```{r}
round(iv.summary$diagnostics["Wu-Hausman",] , 4)
```
 
 
 